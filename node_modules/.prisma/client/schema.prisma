generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Reservation {
  id              String  @id @default(uuid()) @db.VarChar(36)
  reservationCode String? @unique @db.VarChar(6)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  fullName String  @db.VarChar(200)
  cpf      String? @db.VarChar(14)

  people Int
  kids   Int     @default(0)
  area   String? @db.VarChar(64)

  reservationDate DateTime
  birthdayDate    DateTime?

  phone String? @db.VarChar(32)
  email String? @db.VarChar(200)
  notes String? @db.Text

  // âœ… Somente os campos novos
  utm_source   String? @db.VarChar(64)
  utm_medium   String? @db.VarChar(64)
  utm_campaign String? @db.VarChar(128)
  utm_content  String? @db.VarChar(128)
  utm_term     String? @db.VarChar(128)
  url          String? @db.VarChar(512)
  ref          String? @db.VarChar(256)

  unit   String? @db.VarChar(64)
  source String? @db.VarChar(64)

  status      ReservationStatus @default(AWAITING_CHECKIN)
  qrToken     String            @unique @db.VarChar(64)
  qrExpiresAt DateTime?
  checkedInAt DateTime?
  checkedInBy String?           @db.VarChar(64)

  @@index([reservationDate])
  @@index([createdAt])
  @@index([utm_source, utm_campaign])
  @@index([status, reservationDate])
  @@index([unit, createdAt])
  @@index([status, createdAt])
  @@index([reservationCode])
}

enum ReservationStatus {
  AWAITING_CHECKIN
  CHECKED_IN
}
